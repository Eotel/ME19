# プロジェクト概要

このプロジェクトは、カメラから映像を取得し、その映像ストリーム内のQRコードを検出し、デコードしたデータをファイルに書き込みます。

## ファイルの説明

* `ME19/ME19.cpp`: これはメインのアプリケーションファイルです。カメラとQRコードスキャナーを初期化し、ビデオフレームをキャプチャし、ZBarライブラリを使用してQRコードをデコードし、デコードされたデータを`code.txt`に書き込みます。また、プログラム終了シグナルも処理します。
* `ME19/C910CaptureTest.cpp`: このファイルは、`videoInput`ライブラリとOpenCVを使用して、1920x1080の解像度でLogitech C910ウェブカメラからビデオをキャプチャするためのテストプログラムです。基本的なビデオキャプチャと表示機能を示しています。

## 依存関係

* OpenCV: カメラキャプチャと画像処理に使用されます。
* ZBar: QRコードのデコードに使用されます。
* videoInputライブラリ: `C910CaptureTest.cpp`でのビデオキャプチャに使用されます。

## 使い方

* `ME19.cpp`はメインアプリケーションです。このファイルをコンパイルして実行すると、ビデオをキャプチャし、QRコードを検出し、結果を`code.txt`に書き込みます。
* `C910CaptureTest.cpp`はテストプログラムです。このファイルをコンパイルして実行すると、Logitech C910ウェブカメラからのビデオキャプチャをテストできます。

## Goプロジェクトへの移行計画

以下は、現在のC++プロジェクトをGoで再実装するための詳細な計画です。

### タスク一覧

| ID | カテゴリ | タスク | 説明 | 優先度 | 依存関係 | 着手 |
|---|---|---|---|---|---|---|
| 1 | 環境構築 | Goのインストールと環境設定 | Go言語（最新版）をインストールし、GOPATHとGOROOTを設定する | 高 | なし | [x] |
| 2 | 環境構築 | プロジェクト構造の作成 | Go標準のプロジェクト構造を作成し、モジュール初期化（go mod init）を行う | 高 | 1 | [x] |
| 3 | 依存関係 | カメラキャプチャライブラリの調査 | GoでOpenCVの機能を利用するためのライブラリ（gocv等）を調査し選定する | 高 | 1 | [x] |
| 4 | 依存関係 | QRコード読み取りライブラリの調査 | GoでQRコードを読み取るためのライブラリを調査し選定する | 高 | 1 | [x] |
| 5 | 依存関係 | 必要なライブラリのインストール | 選定したライブラリをインストールし、依存関係を設定する | 高 | 3, 4 | [x] |
| 6 | 実装 | カメラキャプチャモジュールの実装 | カメラからの映像取得機能を実装する | 高 | 5 | [x] |
| 7 | 実装 | QRコード検出モジュールの実装 | キャプチャした映像からQRコードを検出する機能を実装する | 高 | 6 | [x] |
| 8 | 実装 | ファイル出力モジュールの実装 | 検出したQRコードの内容をファイルに書き込む機能を実装する | 高 | 7 | [x] |
<<<<<<< HEAD
| 9 | 実装 | シグナルハンドリングの実装 | プログラム終了シグナルを適切に処理する機能を実装する | 中 | 6 | [x] |
| 10 | 実装 | 設定ファイルの実装 | 読み取り間隔やファイルパスなどの設定を外部ファイルから読み込む機能を実装する | 中 | 8 | [x] |
| 11 | テスト | ユニットテストの作成 | 各モジュールのユニットテストを作成する | 中 | 6, 7, 8, 9 | [x] |
| 12 | テスト | 統合テストの作成 | システム全体の統合テストを作成する | 中 | 11 | [x] |
| 13 | ドキュメント | コードドキュメントの作成 | GoDocに準拠したコードドキュメントを作成する | 低 | 6, 7, 8, 9, 10 | [x] |
| 14 | ドキュメント | ユーザードキュメントの作成 | インストール方法、使用方法、設定方法などを記載したドキュメントを作成する | 低 | 13 | [x] |
| 15 | 配布 | バイナリのビルドと配布方法の確立 | 各プラットフォーム向けのバイナリをビルドし、配布する方法を確立する | 低 | 12 | [x] |

### 主要なGoパッケージ候補

* **カメラキャプチャ**: [gocv](https://github.com/hybridgroup/gocv) - GoのOpenCVバインディング
* **QRコード読み取り**: 
  * [gozxing](https://github.com/makiuchi-d/gozxing) - ZXingのGoポート
  * [go-qrcode-reader](https://github.com/tuotoo/qrcode) - 純粋なGoで実装されたQRコードリーダー
* **ファイル操作**: 標準ライブラリの`os`と`io`パッケージ
* **シグナルハンドリング**: 標準ライブラリの`os/signal`パッケージ
* **設定ファイル**: 
  * [viper](https://github.com/spf13/viper) - 設定ファイル管理のための包括的なライブラリ
  * [godotenv](https://github.com/joho/godotenv) - .envファイルからの環境変数読み込み

### プロジェクト構造案

```
me19-go/
├── cmd/
│   └── me19/
│       └── main.go       # エントリーポイント
├── internal/
│   ├── camera/          # カメラキャプチャ関連
│   ├── qrcode/          # QRコード検出関連
│   └── fileio/          # ファイル入出力関連
├── configs/             # 設定ファイル
├── docs/                # ドキュメント
├── tests/               # 統合テスト
├── go.mod               # 依存関係定義
├── go.sum               # 依存関係チェックサム
└── README.md            # プロジェクト説明
```

### 実装方針

1. **モジュール分割**: 機能ごとに明確に分離されたモジュールを作成し、テストと保守を容易にする
2. **エラーハンドリング**: Goの標準的なエラーハンドリングパターンを使用し、適切なログ出力を行う
3. **並行処理**: カメラキャプチャとQRコード検出を別のgoroutineで実行し、パフォーマンスを向上させる
4. **設定の柔軟性**: コマンドライン引数と設定ファイルの両方から設定を読み込めるようにする
5. **クロスプラットフォーム**: Windows、macOS、Linuxで動作するように実装する
